# Pixlator - 像素化图片处理工具

一个基于Web的图片像素化处理工具，支持实时预览、颜色聚类、对角线编号、历史记录管理、图片导出等功能。

## 🎯 功能特性

### 🎨 图片处理
- **图片上传**：支持拖拽上传和点击选择
- **实时预览**：上传后立即显示原图预览
- **尺寸调整**：自动调整图片尺寸，保持宽高比
- **颜色聚类**：使用K-means算法减少颜色数量 (自动/2/4/8/16色)

### 🔢 像素化功能
- **对角线编号**：从右下角开始的对角线编号系统
- **颜色统计**：统计每种颜色的使用次数和位置
- **对角线统计**：分析每条对角线的颜色构成序列
- **实时渲染**：前端React组件实时渲染像素图
- **像素大小调节**：支持4-32px像素大小调整

### 🎯 交互体验
- **参数调节**：实时调整颜色数量和图片尺寸 (10-200px)
- **即时反馈**：参数变化时立即更新像素图
- **响应式设计**：适配不同屏幕尺寸
- **像素高亮**：点击像素或颜色进行高亮显示
- **清除高亮**：一键清除所有高亮状态

### 📚 历史记录管理 ⭐⭐⭐
- **历史记录列表**：显示所有处理过的图片缩略图和信息
- **记录详情**：查看文件信息、处理状态、创建时间
- **重新加载**：点击历史记录重新加载处理结果
- **记录删除**：删除不需要的历史记录
- **状态指示**：显示已处理/未处理状态

### 📤 导出功能 ⭐⭐⭐
- **多格式导出**：支持PNG和JPG格式导出
- **自定义像素大小**：导出时可调整像素大小 (4-32px)
- **导出预览**：显示导出图片的尺寸和像素数量信息
- **自动下载**：导出完成后自动下载文件
- **进度反馈**：显示导出进度和状态

### 📊 使用统计 ⭐⭐
- **系统统计**：显示文件数量、总大小、处理完成率
- **上传趋势**：最近7天的上传统计图表
- **最大文件**：显示系统中最大的文件信息
- **统计面板**：集成在统计面板中的第四个Tab

## 🏗️ 技术架构

### 后端 (Python + FastAPI)
```
src/
├── main.py                 # FastAPI应用入口
├── api/
│   ├── __init__.py
│   ├── routes.py          # API路由定义
│   └── models.py          # Pydantic数据模型
├── services/
│   ├── __init__.py
│   ├── image_processor.py # 图片处理服务
│   ├── pixel_analyzer.py  # 像素分析服务
│   ├── file_manager.py    # 文件管理服务
│   └── export_service.py  # 导出服务
├── utils/
│   ├── __init__.py
│   ├── file_handler.py    # 文件处理工具
│   └── image_utils.py     # 图片工具函数
└── config.py              # 配置文件
```

### 前端 (React + TypeScript)
```
webapp/src/
├── components/
│   ├── ImageUploader/     # 图片上传组件
│   ├── PixelGrid/         # 像素网格组件
│   ├── ColorStats/        # 颜色统计组件
│   ├── DiagonalStats/     # 对角线统计组件
│   ├── ParameterPanel/    # 参数设置面板
│   ├── StatsPanel/        # 统计面板 (四Tab设计)
│   ├── ExportPanel/       # 导出面板
│   └── ImagePreview/      # 图片预览组件
├── hooks/
│   ├── useImageProcessor.ts  # 图片处理逻辑
│   ├── usePixelData.ts       # 像素数据管理
│   ├── useHistory.ts         # 历史记录管理
│   └── useExport.ts          # 导出功能
├── types/
│   └── index.ts             # TypeScript类型定义
└── utils/
    └── api.ts               # API调用工具
```

## 🔄 数据流程

### 1. 图片上传流程
```
用户上传图片 → 前端预览 → 后端保存图片 → 返回文件信息
```

### 2. 图片处理流程
```
用户设置参数 → 调用处理API → 后端像素化处理 → 保存JSON结果 → 返回像素数据 → 前端渲染
```

### 3. 历史记录流程
```
前端请求历史 → 后端扫描uploads目录 → 返回文件列表 → 前端展示历史记录
```

### 4. 恢复处理流程
```
用户点击历史记录 → 加载JSON文件 → 还原像素数据 → 前端重新渲染
```

### 5. 导出流程
```
用户选择导出 → 后端生成文件 → 返回下载链接 → 前端下载文件
```

### 6. 统计信息流程
```
前端请求统计 → 后端分析数据 → 返回统计信息 → 前端展示图表
```

## 🚀 快速开始

### 环境要求
- Python 3.9+
- Node.js 16+
- Yarn 包管理器

### 后端启动
```bash
cd src
pip install -r requirements.txt
python main.py
```

### 前端启动
```bash
cd webapp
yarn install
yarn dev
```

### 访问应用
- 前端: http://localhost:3000
- 后端API: http://localhost:9000

## 📊 项目状态

### ✅ 核心功能完成度: 100%
- ✅ 图片上传和处理
- ✅ 像素化算法实现
- ✅ 颜色和对角线统计
- ✅ 历史记录管理
- ✅ 图片导出功能
- ✅ 使用统计展示

### 🎯 最新版本特性
- **历史记录管理**: 完整的记录管理功能
- **多格式导出**: PNG/JPG格式图片导出
- **使用统计**: 系统使用情况分析
- **四Tab统计面板**: 颜色、对角线、历史、统计
- **响应式优化**: 自适应布局和交互

## 🔮 开发计划

### 下一步功能 (优先级排序)
1. **统计图表可视化** - 颜色分布饼图、对角线长度分布图
2. **数据导出增强** - CSV/JSON格式数据导出
3. **主题系统** - 明暗主题切换
4. **自定义调色板** - 用户自定义颜色管理
5. **性能优化** - 大图片处理优化

## 📝 技术栈

### 后端
- **框架**: FastAPI
- **语言**: Python 3.9+
- **图像处理**: PIL (Pillow)
- **机器学习**: scikit-learn (KMeans)
- **日志**: loguru
- **数据格式**: JSON

### 前端
- **框架**: React 18
- **语言**: TypeScript
- **构建工具**: Vite
- **样式**: Styled Components
- **HTTP 客户端**: Axios
- **文件上传**: React Dropzone

---

**版本**: v1.0.0  
**最后更新**: 2025-07-20  
**开发状态**: 核心功能全部完成，进入高级功能开发阶段